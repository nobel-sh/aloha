// Complex Test: Multiple Features Demo

fun fib(n: number) -> number {
    if (n <= 1) {
        return n;
    }
    return fib(n - 1) + fib(n - 2);
}

fun factorial(n: number) -> number {
    if (n <= 1) {
        return 1;
    }
    return n * factorial(n - 1);
}

fun is_even(n: number) -> number {
    if (n == 0) {
        return 1;
    }
    if (n == 1) {
        return 0;
    }
    if (n < 0) {
        return is_even(-n);
    }
    return is_even(n - 2);
}

fun sum_to_n(n: number) -> number {
    if (n <= 0) {
        return 0;
    }
    return n + sum_to_n(n - 1);
}

fun power(base: number, exp: number) -> number {
    if (exp == 0) {
        return 1;
    }
    return base * power(base, exp - 1);
}

fun main() -> number {
    println("=== Aloha Complex Test ===");
    println("");
    
    println("Fibonacci:");
    print("  fib(5) = ");
    printlnNum(fib(5));
    print("  fib(8) = ");
    printlnNum(fib(8));
    println("");
    
    println("Factorial:");
    print("  5! = ");
    printlnNum(factorial(5));
    print("  7! = ");
    printlnNum(factorial(7));
    println("");
    
    println("Even/Odd:");
    print("  is_even(8) = ");
    printlnNum(is_even(8));
    print("  is_even(7) = ");
    printlnNum(is_even(7));
    println("");
    
    println("Sum to N:");
    print("  sum(1..10) = ");
    printlnNum(sum_to_n(10));
    println("");
    
    println("Power:");
    print("  2^8 = ");
    printlnNum(power(2, 8));
    print("  3^4 = ");
    printlnNum(power(3, 4));
    println("");
    
    println("Complex expressions:");
    print("  (fib(5) + factorial(3)) * 2 = ");
    printlnNum((fib(5) + factorial(3)) * 2);
    println("");
    
    println("=== All Tests Passed ===");
    return 0;
}
